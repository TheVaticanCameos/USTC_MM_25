# 作业3：数据拟合模型

> 作业 ddl：2025年4月12日（周六）23:59
> 提交内容：源代码 + 实验报告（pdf文件） + 其他补充说明文件（可选）

在数学建模领域，函数拟合是研究数据规律、建立模型的重要手段。它通过寻找一个合适的函数来描述输入与输出之间的关系，从而实现对未知数据的预测和分类。在本实验中，我们将从如下两个选项中任选其一来练习函数拟合的建模方式。

> 注：为了避免无效内卷，**做多个任务的同学只按照实验报告中的第一个任务呈现分数**，**且最终以完成度为评判标准，与任务的本质难度无关，做较难作业的同学不一定得到更高的分数**

## 选项1：平面点列的曲线拟合（WIP）

To be updated

## 选项2：使用神经网络进行昆虫分类

### 问题背景

在某些应用场景中，我们需要自动化地对给定的数据进行分类。比如，给定一些猫和狗的图片，我们需要筛选出其中哪些是“猫”，哪些是“狗”，这就是一个典型的**分类任务**。这类问题的一种常见形式如下：

已知给定的数据集 $ \mathcal{X} $ 可以划分为 $ n $ 个类别（假设每个样本属于且只属于其中一个类别），记为 $ A_1, A_2, \dots, A_n $。假设我们已有一批观测数据 $ \{x_k\}_{k=1}^m $，以及其所属的类别 $ c_1, c_2, \dots, c_m $，我们需要找到一个函数 $ f $，使得 \[ f(x_k)=c_k, k=1, 2, \dots, m \] 从而，当给定这批观测数据之外的新数据 $ x_j $ 时，我们希望此函数值 $ f(x_j) $ 能够忠实地反映 $ x_j $ 真正所属的类别。

> 注：在实际操作时，由于样本 $ x_k $ 未必是一个容易处理的数据类型（比如一张图片、一段文本），我们往往需要先对样本进行**特征提取**，得到原始样本的数字特征表示，将这些“数字”（而不是样本本身）作为输入，来拟合目标函数。例如，在图像分类任务中，常常使用卷积神经网络（CNN）来完成特征提取。

### 实验内容

具体到本次实验，我们将对昆虫的分类问题进行研究。假设数据中的昆虫有3个类别，分别使用0,1,2表示。为了简化实验，我们假设已经得到了昆虫样本的“体长”和“翼长”这两个特征表示，并假设仅使用这两组特征即可对其类别进行分类。实验数据集见 [insects 文件夹](./insects/)，其中数据集分为两组，每个文件的说明如下：
- 数据集1：
    - `insects-training.txt` 为生物学家所鉴定的分类结果，作为训练集
    - `insects-testing.txt` 作为测试集，其中数据可分为两部分来进行测试：
        - 前 60 个为从训练数据中随机抽取的
        - 后 150 个为不在训练数据中的新数据
- 数据集2：
    - `insects-2-training.txt` 为带有噪音（测量误差）的数据，并且已被生物学家进行鉴定，作为训练集
    - `insects-2-testing.txt` 为带有噪音的数据集，作为测试集，其中的数据来源同 `insects-testing.txt`

其中每个文件内部的数据格式为：每一行用 (x, y, label) 表示，x 为体长值，y 为翼长值，label 为所属的类别（0/1/2）

**你的任务：请使用神经网络来对上述昆虫数据进行分类，不限制具体使用的网络模型。**

具体实现时，请对每组数据（数据集1/数据集2）分别进行实验；在每个实验中，请先在训练集上训练你的神经网络模型（即最小化你的网络输出和真实数据对应的 label 之间的距离），然后在测试集上测试模型的分类准确度。测试时，请分别在前 60 个和后 150 个数据上进行测试（思考：为什么要这样处理？）。

### 实验要求

本选项的实验基本要求如下：
- 按照上一节中的要求，完成2组数据集上的实验
- 测试不同网络参数（如网络结构、激活函数，etc）对实验结果的影响
- 分析神经网络模型方法的影响因素

注：
- 本次实验不限制编程语言
- 本选项不对图形界面作要求
- 推荐使用 `PyTorch` 作为深度学习框架

可能的加分项：如何更好地展示你的实验结果？如何更有力地论证你的模型能够有效处理这一分类任务？数据集2和数据集1有什么区别、分别如何处理？etc

### 一些参考资料

深度学习相关教程：
- [动手学深度学习](https://zh.d2l.ai/)
- [训练集、验证集和测试集的关系](https://zhuanlan.zhihu.com/p/377789735)   （提示：请仔细阅读并体会）

`PyTorch` 相关教程：
- [Windows 端 PyTorch 环境搭建](https://blog.csdn.net/MANCXUARY/article/details/128798637)
- [Linux 端 PyTorch 环境搭建(Ubuntu)](https://blog.csdn.net/KRISNAT/article/details/124068391)
- [PyTorch 使用教程](https://www.runoob.com/pytorch/pytorch-tutorial.html)

# 作业3：数据拟合模型

> 作业 ddl：2025年4月12日（周六）23:59
> 提交内容：源代码 + 实验报告（pdf文件） + 其他补充说明文件（可选）

在数学建模领域，函数拟合是研究数据规律、建立模型的重要手段。它通过寻找一个合适的函数来描述输入与输出之间的关系，从而实现对未知数据的预测和分类。在本实验中，我们将从如下两个选项中任选其一来练习函数拟合的建模方式。

> 注：为了避免无效内卷，**做多个任务的同学只按照实验报告中的第一个任务呈现分数**，**且最终以完成度为评判标准，与任务的本质难度无关，做较难作业的同学不一定得到更高的分数**

## 选项1：平面点列的曲线拟合

### 问题背景

假设我们对一条平面曲线进行了采样，得到了若干散点，如何根据这些散点的信息恢复出原始曲线？换言之，我们如何找到一条平面曲线，使得它与这些采样的散点背后的真实曲线足够接近？

此时，我们的面前出现了两个问题：

1. 用什么方式来表达一条平面曲线？
2. 如何衡量一条曲线与目标曲线的接近程度？

#### 平面曲线的表达方式

我们知道，单变量连续函数的图像是一条平面曲线，那么很自然的想法是用一个连续函数的自变量-因变量点对来表示曲线，从而将原问题转化为了简单的函数拟合问题。

然而，由于函数图像要求每个自变量的值只能对应唯一一个因变量的值，这样的表达方式显然无法囊括所有平面曲线，因此我们需要更好的表达方式，即曲线的参数化。

微分几何的知识告诉我们，对于任意满足一定正则性条件的平面曲线 $\gamma$，我们都可以将其表达为参数曲线的形式： $\mathbf{r}(t)=(x(t), y(t))$，其中映射 $\mathbf{r}:[0, 1]\longrightarrow \mathbb{R}^2$ 是连续的双射。从而，我们可以通过两个将 $[0, 1]$ 映射到 $\mathbb{R}$ 的函数 $x(t), y(t)$ 来表示这条待求解的平面曲线。

#### 如何找到一条“好”的曲线

在上一节中，我们已经解决了曲线表达方式的问题。假设我们已经有了一条曲线，如何衡量这条曲线与采样点之间的接近程度呢？我们可以有如下选择：

##### 在采样点处插值

一种直接的方式是：让我们的曲线通过每一个采样点。这听起来很显然，然而隐藏的问题是：我们知道这些散点的采样顺序吗？换言之，由于将平面中的一组散点连成曲线的方式并不唯一（dbq 这里助教懒得画图说明了 TAT），**我们需要事先指定采样点的连接顺序，才能通过曲线插值的方式处理。如果你使用了这种处理方式，请在实验报告中说明相关假设。**

> 思考：如果采样散点的顺序未知，又应该如何处理？

假设我们已经有了采样点的连接顺序，设为 $P_1, P_2, \dots, P_n$，我们只需要找到函数 $x(t), y(t)$，使得 

$$
(x(t_k), y(t_k)) = P_k, k=1, 2, \dots, n 
$$

这时候我们发现其中的 $t_k$ 的值可以有我们自由指定，只需要满足 $0\leq t_1<t_2<\cdots < t_n\leq 1$ 即可。这样我们便将原问题转化为了两个函数的插值问题，可以采用多项式插值/三角插值/RBF插值等一系列插值算法处理。

事实上，对于上述 $t_k$ 的不同选取方式，在很大程度上会影响我们得到的曲线的形态。这部分可以参考如下文献：

- [Choosing Nodes in Parametric Curve Interpolation](https://dlnext.acm.org/doi/10.1016/0010-4485%2889%2990003-1)
- [Parameterization for Curve Interpolation](https://www.mn.uio.no/math/english/people/aca/michaelf/papers/curve_survey.pdf)
- [A Method for Determining Knots in Parametric Curve Interpolation](https://dl.acm.org/doi/10.1016/S0167-8396%2897%2900041-1)

##### 对采样点做曲线拟合

上述插值的思路隐含的假设是“所有采样都是零误差的”。事实上，在很多情况下，采样点本身就存在误差，用这些采样点来插值未必能够很精确地还原出原始曲线；另一方面，由于高阶多项式插值存在 [Runge 现象](https://zh.wikipedia.org/wiki/%E9%BE%99%E6%A0%BC%E7%8E%B0%E8%B1%A1)，使用插值来还原原始曲线在有的情况下未必是好的选择。我们可能会更希望得到一条曲线，它距离采样点的“平均距离”尽可能小。通过合理地定义这个“平均距离”，我们可以将原问题转化为一个优化问题来处理。

> 注意：选项1是一个开放的问题，除上述两种思路外，我们也欢迎你在实验中使用其他思路！

### 实验要求

本实验的基本要求如下：
- 在合理的假设下，能够有效解决平面曲线的拟合问题
- 充分且清晰地展示你的实验结果
- 不限制编程语言；不对 GUI 有硬性要求

可能的加分点：你的程序如何更加合理地与用户交互？不同方法有何优缺点？如何展示你的方法的鲁棒性？不同插值函数之间的对比？不同“平均距离”的定义方式有何异同？etc

## 选项2：使用神经网络进行昆虫分类

### 问题背景

在某些应用场景中，我们需要自动化地对给定的数据进行分类。比如，给定一些猫和狗的图片，我们需要筛选出其中哪些是“猫”，哪些是“狗”，这就是一个典型的**分类任务**。这类问题的一种常见形式如下：

已知给定的数据集 $\mathcal{X}$ 可以划分为 $n$ 个类别（假设每个样本属于且只属于其中一个类别），记为 $A_1, A_2, \dots, A_n$ 。假设我们已有一批观测数据 $\{x_k\}_{k=1}^m$ ，以及其所属的类别 $c_1, c_2, \dots, c_m$ ，我们需要找到一个函数 $f$，使得

$$ 
f(x_k)=c_k, k=1, 2, \dots, m
$$

从而，当给定这批观测数据之外的新数据 $x_j$ 时，我们希望此函数值 $f(x_j)$ 能够忠实地反映 $x_j$ 真正所属的类别。

> 注：在实际操作时，由于样本 $x_k$ 未必是一个容易处理的数据类型（比如一张图片、一段文本），我们往往需要先对样本进行**特征提取**，得到原始样本的数字特征表示，将这些“数字”（而不是样本本身）作为输入，来拟合目标函数。例如，在图像分类任务中，常常使用卷积神经网络（CNN）来完成特征提取。

### 实验内容

具体到本次实验，我们将对昆虫的分类问题进行研究。假设数据中的昆虫有3个类别，分别使用0,1,2表示。为了简化实验，我们假设已经得到了昆虫样本的“体长”和“翼长”这两个特征表示，并假设仅使用这两组特征即可对其类别进行分类。实验数据集见 [insects 文件夹](./insects/)，其中数据集分为两组，每个文件的说明如下：
- 数据集1：
    - `insects-training.txt` 为生物学家所鉴定的分类结果，作为训练集
    - `insects-testing.txt` 作为测试集，其中数据可分为两部分来进行测试：
        - 前 60 个为从训练数据中随机抽取的
        - 后 150 个为不在训练数据中的新数据
- 数据集2：
    - `insects-2-training.txt` 为带有噪音（测量误差）的数据，并且已被生物学家进行鉴定，作为训练集
    - `insects-2-testing.txt` 为带有噪音的数据集，作为测试集，其中的数据来源同 `insects-testing.txt`

其中每个文件内部的数据格式为：每一行用 (x, y, label) 表示，x 为体长值，y 为翼长值，label 为所属的类别（0/1/2）

**你的任务：请使用神经网络来对上述昆虫数据进行分类，不限制具体使用的网络模型。**

具体实现时，请对每组数据（数据集1/数据集2）分别进行实验；在每个实验中，请先在训练集上训练你的神经网络模型（即最小化你的网络输出和真实数据对应的 label 之间的距离），然后在测试集上测试模型的分类准确度。测试时，请分别在前 60 个和后 150 个数据上进行测试（思考：为什么要这样处理？）。

### 实验要求

本选项的实验基本要求如下：
- 按照上一节中的要求，完成2组数据集上的实验
- 测试不同网络参数（如网络结构、激活函数，etc）对实验结果的影响
- 分析神经网络模型方法的影响因素

注：
- 本次实验不限制编程语言
- 本选项不对图形界面作要求
- 推荐使用 `PyTorch` 作为深度学习框架

可能的加分项：如何更好地展示你的实验结果？如何更有力地论证你的模型能够有效处理这一分类任务？数据集2和数据集1有什么区别、分别如何处理？etc

### 一些参考资料

深度学习相关教程：
- [动手学深度学习](https://zh.d2l.ai/)
- [训练集、验证集和测试集的关系](https://zhuanlan.zhihu.com/p/377789735)   （提示：请仔细阅读并体会）

`PyTorch` 相关教程：
- [Windows 端 PyTorch 环境搭建](https://blog.csdn.net/MANCXUARY/article/details/128798637)
- [Linux 端 PyTorch 环境搭建(Ubuntu)](https://blog.csdn.net/KRISNAT/article/details/124068391)
- [PyTorch 使用教程](https://www.runoob.com/pytorch/pytorch-tutorial.html)
